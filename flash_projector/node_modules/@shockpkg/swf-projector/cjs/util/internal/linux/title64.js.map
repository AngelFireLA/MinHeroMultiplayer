{"version":3,"file":"title64.js","names":["_asm","require","_title","PatchTitle64","PatchTitle","exports","title64","_addr_","check","shdr","i","d","_findFuzzyCode","TITLE_X8664","v","DataView","buffer","byteOffset","byteLength","addr","shAddr","BigInt","rip","ptr","getUint32","len","str","_readCstr","length","titleMatchA","test","patch","_theShdrForAddress","data","Number","setUint32","_titleA","_titleL"],"sources":["../../../../src/util/internal/linux/title64.ts"],"sourcesContent":["/* eslint-disable max-classes-per-file */\n\nimport {TITLE_X8664} from './asm.ts';\nimport {Elf64} from './elf.ts';\nimport {PatchTitle, titleMatchA} from './title.ts';\n\n/**\n * PatchTitle64 object.\n */\nexport abstract class PatchTitle64 extends PatchTitle<Elf64> {}\n\n/**\n * Patch objects.\n */\nexport const title64 = [\n\t/**\n\t * 24.0.0.186 x86_64.\n\t */\n\tclass extends PatchTitle64 {\n\t\tprivate _addr_ = 0n;\n\n\t\t/**\n\t\t * @inheritDoc\n\t\t */\n\t\tpublic check() {\n\t\t\tfor (const [shdr, i, d] of this._findFuzzyCode(TITLE_X8664['24'])) {\n\t\t\t\tconst v = new DataView(d.buffer, d.byteOffset, d.byteLength);\n\t\t\t\tconst addr = shdr.shAddr + BigInt(i);\n\t\t\t\tconst rip = addr + 7n;\n\t\t\t\tconst ptr = rip + BigInt(v.getUint32(i + 3, true));\n\t\t\t\tconst len = v.getUint32(i + 8, true);\n\t\t\t\tconst str = this._readCstr(ptr);\n\t\t\t\tif (!str || str.length !== len || !titleMatchA.test(str)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (this._addr_) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis._addr_ = addr;\n\t\t\t}\n\t\t\treturn !!this._addr_;\n\t\t}\n\n\t\t/**\n\t\t * @inheritDoc\n\t\t */\n\t\tpublic patch() {\n\t\t\tconst addr = this._addr_;\n\t\t\tconst shdr = this._theShdrForAddress(addr);\n\t\t\tconst v = new DataView(shdr.data);\n\t\t\tconst i = Number(addr - shdr.shAddr);\n\t\t\tconst rip = shdr.shAddr + BigInt(i + 7);\n\t\t\tv.setUint32(i + 3, Number(this._titleA - rip), true);\n\t\t\tv.setUint32(i + 8, this._titleL, true);\n\t\t}\n\t}\n] as (new (elf: Elf64, titleA: bigint, titleL: number) => PatchTitle64)[];\n"],"mappings":";;;;;;AAEA,IAAAA,IAAA,GAAAC,OAAA;AAEA,IAAAC,MAAA,GAAAD,OAAA;AAJA;;AAMA;AACA;AACA;AACO,MAAeE,YAAY,SAASC,iBAAU,CAAQ;;AAE7D;AACA;AACA;AAFAC,OAAA,CAAAF,YAAA,GAAAA,YAAA;AAGO,MAAMG,OAAO,GAAAD,OAAA,CAAAC,OAAA,GAAG;AACtB;AACD;AACA;AACC,cAAcH,YAAY,CAAC;EAClBI,MAAM,GAAG,EAAE;;EAEnB;AACF;AACA;EACSC,KAAKA,CAAA,EAAG;IACd,KAAK,MAAM,CAACC,IAAI,EAAEC,CAAC,EAAEC,CAAC,CAAC,IAAI,IAAI,CAACC,cAAc,CAACC,gBAAW,CAAC,IAAI,CAAC,CAAC,EAAE;MAClE,MAAMC,CAAC,GAAG,IAAIC,QAAQ,CAACJ,CAAC,CAACK,MAAM,EAAEL,CAAC,CAACM,UAAU,EAAEN,CAAC,CAACO,UAAU,CAAC;MAC5D,MAAMC,IAAI,GAAGV,IAAI,CAACW,MAAM,GAAGC,MAAM,CAACX,CAAC,CAAC;MACpC,MAAMY,GAAG,GAAGH,IAAI,GAAG,EAAE;MACrB,MAAMI,GAAG,GAAGD,GAAG,GAAGD,MAAM,CAACP,CAAC,CAACU,SAAS,CAACd,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;MAClD,MAAMe,GAAG,GAAGX,CAAC,CAACU,SAAS,CAACd,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC;MACpC,MAAMgB,GAAG,GAAG,IAAI,CAACC,SAAS,CAACJ,GAAG,CAAC;MAC/B,IAAI,CAACG,GAAG,IAAIA,GAAG,CAACE,MAAM,KAAKH,GAAG,IAAI,CAACI,kBAAW,CAACC,IAAI,CAACJ,GAAG,CAAC,EAAE;QACzD;MACD;MACA,IAAI,IAAI,CAACnB,MAAM,EAAE;QAChB,OAAO,KAAK;MACb;MACA,IAAI,CAACA,MAAM,GAAGY,IAAI;IACnB;IACA,OAAO,CAAC,CAAC,IAAI,CAACZ,MAAM;EACrB;;EAEA;AACF;AACA;EACSwB,KAAKA,CAAA,EAAG;IACd,MAAMZ,IAAI,GAAG,IAAI,CAACZ,MAAM;IACxB,MAAME,IAAI,GAAG,IAAI,CAACuB,kBAAkB,CAACb,IAAI,CAAC;IAC1C,MAAML,CAAC,GAAG,IAAIC,QAAQ,CAACN,IAAI,CAACwB,IAAI,CAAC;IACjC,MAAMvB,CAAC,GAAGwB,MAAM,CAACf,IAAI,GAAGV,IAAI,CAACW,MAAM,CAAC;IACpC,MAAME,GAAG,GAAGb,IAAI,CAACW,MAAM,GAAGC,MAAM,CAACX,CAAC,GAAG,CAAC,CAAC;IACvCI,CAAC,CAACqB,SAAS,CAACzB,CAAC,GAAG,CAAC,EAAEwB,MAAM,CAAC,IAAI,CAACE,OAAO,GAAGd,GAAG,CAAC,EAAE,IAAI,CAAC;IACpDR,CAAC,CAACqB,SAAS,CAACzB,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC2B,OAAO,EAAE,IAAI,CAAC;EACvC;AACD,CAAC,CACuE","ignoreList":[]}