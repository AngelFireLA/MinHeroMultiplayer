{"version":3,"file":"array.js","names":["_options","require","_util","_value","_boolean","_data","_dict","_integer","_real","_string","childTagNames","ValueArray","Value","TYPE","TAG_NAMES","CHILD_TAG_NAMES","Map","ValueType","ValueBoolean","ValueData","ValueDict","ValueInteger","ValueReal","ValueString","t","set","value","constructor","length","get","index","getValue","r","Error","push","values","pop","popValue","shift","shiftValue","fromXmlElement","element","assertXmlTagName","children","xmlElementChildElements","map","el","childFromXmlElement","tagName","toXml","options","depth","n","newlineString","NEWLINE_STRING","p","indentString","INDENT_STRING","repeat","v","exports"],"sources":["../../src/value/array.ts"],"sourcesContent":["import {INDENT_STRING, NEWLINE_STRING, IToXmlOptions} from '../options.ts';\nimport {IElement, assertXmlTagName, xmlElementChildElements} from '../util.ts';\nimport {Value} from '../value.ts';\n\nimport {ValueBoolean} from './boolean.ts';\nimport {ValueData} from './data.ts';\nimport {ValueDict} from './dict.ts';\nimport {ValueInteger} from './integer.ts';\nimport {ValueReal} from './real.ts';\nimport {ValueString} from './string.ts';\n\nlet childTagNames: Readonly<Map<string, new () => Value>>;\n\n/**\n * ValueArray object.\n */\nexport class ValueArray extends Value {\n\t/**\n\t * Value type.\n\t */\n\tpublic static readonly TYPE = 'array';\n\n\t/**\n\t * Tag names.\n\t */\n\tpublic static readonly TAG_NAMES = ['array'];\n\n\t/**\n\t * Child tag names.\n\t *\n\t * @returns Child tag names map.\n\t */\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tpublic static get CHILD_TAG_NAMES() {\n\t\tif (!childTagNames) {\n\t\t\tchildTagNames = new Map();\n\t\t\tfor (const ValueType of [\n\t\t\t\tValueArray,\n\t\t\t\tValueBoolean,\n\t\t\t\tValueData,\n\t\t\t\tValueDict,\n\t\t\t\tValueInteger,\n\t\t\t\tValueReal,\n\t\t\t\tValueString\n\t\t\t]) {\n\t\t\t\tfor (const t of ValueType.TAG_NAMES) {\n\t\t\t\t\tchildTagNames.set(t, ValueType);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn childTagNames;\n\t}\n\n\t/**\n\t * Value value.\n\t */\n\tpublic value: Value[] = [];\n\n\t/**\n\t * ValueArray constructor.\n\t *\n\t * @param value The value.\n\t */\n\tconstructor(value: Value[] = []) {\n\t\tsuper();\n\n\t\tthis.value = value;\n\t}\n\n\t/**\n\t * Array length.\n\t *\n\t * @returns The length.\n\t */\n\tpublic get length() {\n\t\treturn this.value.length;\n\t}\n\n\t/**\n\t * Get value at index or null if out of bounds.\n\t *\n\t * @param index Array index.\n\t * @returns The value or null.\n\t */\n\tpublic get(index: number) {\n\t\tconst {value} = this;\n\t\treturn index < this.length ? value[index] : null;\n\t}\n\n\t/**\n\t * Get value at index or throw.\n\t *\n\t * @param index Array index.\n\t * @returns The value.\n\t */\n\tpublic getValue(index: number) {\n\t\tconst r = this.get(index);\n\t\tif (!r) {\n\t\t\tthrow new Error(`Index out of bounds: ${index}`);\n\t\t}\n\t\treturn r;\n\t}\n\n\t/**\n\t * Set value at index.\n\t *\n\t * @param index Array index.\n\t * @param value Value object.\n\t */\n\tpublic set(index: number, value: Value) {\n\t\tthis.value[index] = value;\n\t}\n\n\t/**\n\t * Push values onto array.\n\t *\n\t * @param values Value objects.\n\t */\n\tpublic push(...values: Value[]) {\n\t\tthis.value.push(...values);\n\t}\n\n\t/**\n\t * Pop value off array or null.\n\t *\n\t * @returns Value object or null.\n\t */\n\tpublic pop() {\n\t\treturn this.value.pop() || null;\n\t}\n\n\t/**\n\t * Pop value off array or throw.\n\t *\n\t * @returns Value object or null.\n\t */\n\tpublic popValue() {\n\t\tconst r = this.pop();\n\t\tif (!r) {\n\t\t\tthrow new Error('Cannot pop empty array');\n\t\t}\n\t\treturn r;\n\t}\n\n\t/**\n\t * Shift value off array or null.\n\t *\n\t * @returns Value object or null.\n\t */\n\tpublic shift() {\n\t\treturn this.value.shift() || null;\n\t}\n\n\t/**\n\t * Pop value off array or throw.\n\t *\n\t * @returns Value object or null.\n\t */\n\tpublic shiftValue() {\n\t\tconst r = this.shift();\n\t\tif (!r) {\n\t\t\tthrow new Error('Cannot shift empty array');\n\t\t}\n\t\treturn r;\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic fromXmlElement(element: Readonly<IElement>) {\n\t\tassertXmlTagName(element, 'array');\n\t\tconst children = xmlElementChildElements(element);\n\t\tthis.value = children.map(el => this.childFromXmlElement(el));\n\t}\n\n\t/**\n\t * Decode child element from XML element.\n\t *\n\t * @param element XML element.\n\t * @returns Value element.\n\t */\n\tpublic childFromXmlElement(element: Readonly<IElement>) {\n\t\tconst {tagName} = element;\n\t\tconst {CHILD_TAG_NAMES} = this.constructor as typeof ValueArray;\n\t\tconst Value = CHILD_TAG_NAMES.get(tagName) || null;\n\t\tif (!Value) {\n\t\t\tthrow new Error(`Unknown element type: ${tagName}`);\n\t\t}\n\t\tconst r = new Value();\n\t\tr.fromXmlElement(element);\n\t\treturn r;\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic toXml(options: Readonly<IToXmlOptions> | null = null, depth = 0) {\n\t\tconst n = options?.newlineString ?? NEWLINE_STRING;\n\t\tconst p = (options?.indentString ?? INDENT_STRING).repeat(depth);\n\t\tconst v = this.value;\n\t\tif (!v.length) {\n\t\t\treturn `${p}<array/>`;\n\t\t}\n\t\tlet r = `${p}<array>`;\n\t\tfor (const el of v) {\n\t\t\tr += `${n}${el.toXml(options, depth + 1)}`;\n\t\t}\n\t\tr += `${n}${p}</array>`;\n\t\treturn r;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}